Public Class Level3
    Private num1 As Integer
    Private num2 As Integer
    Private score As Integer
    Private rand As Random
    Private questionNumber As Integer

    Public Sub New()
        InitializeComponent()
        rand = New Random()
        ResetGame()
    End Sub

    Private Sub ResetGame()
        score = 0
        questionNumber = 1
        ScoreLabel.Text = $"Score: {score}"
        LevelLabel.Text = "Level: 3"
        NextLevelButton.Visible = False
        GenerateQuestion()
    End Sub

    Private Sub GenerateQuestion()
        If score < 5 Then
            num2 = rand.Next(1, 6)
            Dim product As Integer = rand.Next(1, 6) * num2
            num1 = product

            QuestionTitle.Text = $"Question {questionNumber}: What is {num1} / {num2}?"

            questionNumber += 1
        Else
            QuestionTitle.Text = "Congratulations! You can now go to the next level!"
            NextLevelButton.Visible = True
        End If
    End Sub

    Private Sub SubmitButton_Click(sender As Object, e As EventArgs) Handles SubmitButton.Click
        Dim Answer As Integer
        If Integer.TryParse(AnswerBox.Text, Answer) Then
            Dim correctAnswer As Integer
            correctAnswer = num1 \ num2

            If Answer = correctAnswer Then
                MessageBox.Show("Correct!")
                score += 1
                AnswerBox.Clear()
                GenerateQuestion()
            Else
                MessageBox.Show("Incorrect, try again!")
            End If
            ScoreLabel.Text = $"Score: {score}"
        Else
            MessageBox.Show("Please enter a valid number.")
        End If
    End Sub

    Private Sub SkipButton_Click(sender As Object, e As EventArgs) Handles SkipButton.Click
        AnswerBox.Clear()
        GenerateQuestion()
    End Sub

    Private Sub RestartButton_Click(sender As Object, e As EventArgs) Handles RestartButton.Click
        ResetGame()
    End Sub

    Private Sub ExitButton_Click(sender As Object, e As EventArgs) Handles ExitButton.Click
        Application.Exit()
    End Sub

    Private Sub NextLevelButton_Click(sender As Object, e As EventArgs) Handles NextLevelButton.Click
        Dim level4 As New Level4()
        level4.Show()
        Me.Hide()
    End Sub

End Class
